<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Projetos e Funcionários</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#1E40AF',
                        success: '#10B981',
                        warning: '#F59E0B',
                        danger: '#EF4444'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col sm:flex-row justify-between items-center py-6 space-y-4 sm:space-y-0">
                <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">Sistema de Gestão</h1>
                <div class="flex space-x-2 sm:space-x-4">
                    <button id="projetosTab" class="px-3 sm:px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-colors text-sm sm:text-base">
                        Projetos
                    </button>
                    <button id="funcionariosTab" class="px-3 sm:px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm sm:text-base">
                        Funcionários
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Projetos Section -->
        <div id="projetosSection" class="space-y-6">
            <!-- Projetos Header -->
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0">
                <h2 class="text-2xl font-bold text-gray-900">Gestão de Projetos</h2>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                    <div class="flex space-x-2">
                        <input type="number" id="buscarProjetoId" placeholder="Buscar por ID" 
                               class="px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary w-32">
                        <button id="buscarProjetoBtn" class="px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">
                            Buscar
                        </button>
                        <button id="listarTodosProjetosBtn" class="px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors">
                            Listar Todos
                        </button>
                    </div>
                    <button id="novoProjetoBtn" class="px-4 py-2 bg-success text-white rounded-lg hover:bg-green-600 transition-colors">
                        + Novo Projeto
                    </button>
                </div>
            </div>

            <!-- Projetos List -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900">Lista de Projetos</h3>
                </div>
                <div id="projetosList" class="divide-y divide-gray-200">
                    <!-- Projetos serão carregados aqui via JavaScript -->
                </div>
            </div>
        </div>

        <!-- Funcionários Section -->
        <div id="funcionariosSection" class="space-y-6 hidden">
            <!-- Funcionários Header -->
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0">
                <h2 class="text-2xl font-bold text-gray-900">Gestão de Funcionários</h2>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                    <div class="flex space-x-2">
                        <input type="number" id="buscarFuncionarioId" placeholder="Buscar por ID" 
                               class="px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary w-32">
                        <button id="buscarFuncionarioBtn" class="px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">
                            Buscar
                        </button>
                        <button id="listarTodosFuncionariosBtn" class="px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors">
                            Listar Todos
                        </button>
                    </div>
                    <button id="novoFuncionarioBtn" class="px-4 py-2 bg-success text-white rounded-lg hover:bg-green-600 transition-colors">
                        + Novo Funcionário
                    </button>
                </div>
            </div>

            <!-- Funcionários List -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900">Lista de Funcionários</h3>
                </div>
                <div id="funcionariosList" class="divide-y divide-gray-200">
                    <!-- Funcionários serão carregados aqui via JavaScript -->
                </div>
            </div>
        </div>
    </main>

    <!-- Modal para Projetos -->
    <div id="projetoModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full max-h-screen overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 id="projetoModalTitle" class="text-lg font-semibold text-gray-900">Novo Projeto</h3>
                </div>
                <form id="projetoForm" class="p-6 space-y-4">
                    <div>
                        <label for="projetoNome" class="block text-sm font-medium text-gray-700">Nome do Projeto</label>
                        <input type="text" id="projetoNome" name="nome" required
                               class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                    </div>
                    <div>
                        <label for="projetoDescricao" class="block text-sm font-medium text-gray-700">Descrição</label>
                        <textarea id="projetoDescricao" name="descricao" rows="3" required
                                  class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"></textarea>
                    </div>
                    <div>
                        <label for="projetoDataCriacao" class="block text-sm font-medium text-gray-700">Data de Criação</label>
                        <input type="date" id="projetoDataCriacao" name="dataCriacao" required
                               class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Funcionários Associados</label>
                        <div id="funcionariosProjetoContainer" class="space-y-2">
                            <div class="flex space-x-2">
                                <input type="text" placeholder="Nome do funcionário" 
                                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-nome">
                                <input type="text" placeholder="CPF" 
                                       class="w-32 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-cpf">
                                <input type="email" placeholder="Email" 
                                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-email">
                                <input type="number" placeholder="Salário" step="0.01" 
                                       class="w-24 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-salario">
                                <button type="button" onclick="removerFuncionarioProjeto(this)" class="px-2 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors">
                                    -
                                </button>
                            </div>
                        </div>
                        <button type="button" onclick="adicionarFuncionarioProjeto()" class="mt-2 px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors">
                            + Adicionar Funcionário
                        </button>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" id="cancelarProjeto" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors">
                            Cancelar
                        </button>
                        <button type="submit" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Funcionários -->
    <div id="funcionarioModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full max-h-screen overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 id="funcionarioModalTitle" class="text-lg font-semibold text-gray-900">Novo Funcionário</h3>
                </div>
                <form id="funcionarioForm" class="p-6 space-y-4">
                    <div>
                        <label for="funcionarioNome" class="block text-sm font-medium text-gray-700">Nome</label>
                        <input type="text" id="funcionarioNome" name="nome" required
                               class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                    </div>
                    <div>
                        <label for="funcionarioCpf" class="block text-sm font-medium text-gray-700">CPF</label>
                        <input type="text" id="funcionarioCpf" name="cpf" required
                               class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                    </div>
                    <div>
                        <label for="funcionarioEmail" class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" id="funcionarioEmail" name="email" required
                               class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                    </div>
                    <div>
                        <label for="funcionarioSalario" class="block text-sm font-medium text-gray-700">Salário</label>
                        <input type="number" id="funcionarioSalario" name="salario" step="0.01" required
                               class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Projetos Associados</label>
                        <div id="projetosFuncionarioContainer" class="space-y-2">
                            <div class="flex space-x-2">
                                <input type="text" placeholder="Nome do projeto" 
                                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary projeto-nome">
                                <textarea placeholder="Descrição" rows="2" 
                                          class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary projeto-descricao"></textarea>
                                <button type="button" onclick="removerProjetoFuncionario(this)" class="px-2 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors">
                                    -
                                </button>
                            </div>
                        </div>
                        <button type="button" onclick="adicionarProjetoFuncionario()" class="mt-2 px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors">
                            + Adicionar Projeto
                        </button>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" id="cancelarFuncionario" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors">
                            Cancelar
                        </button>
                        <button type="submit" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- Toast para notificações -->
    <div id="toast" class="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full opacity-0 transition-all duration-300 pointer-events-none">
        <span id="toastMessage">Operação realizada com sucesso!</span>
    </div>

    <script>
        // Configuração dos endpoints da API
        const API_ENDPOINTS = {
            projetos: {
                base: 'http://localhost:8080/api/projetos',
                get: 'http://localhost:8080/api/projetos',
                getById: (id) => `http://localhost:8080/api/projetos/${id}`,
                post: 'http://localhost:8080/api/projetos'
            },
            funcionarios: {
                base: 'http://localhost:8080/api/funcionarios',
                get: 'http://localhost:8080/api/funcionarios',
                getById: (id) => `http://localhost:8080/api/funcionarios/${id}`,
                post: 'http://localhost:8080/api/funcionarios'
            }
        };

        // Estado da aplicação
        let projetos = [];
        let funcionarios = [];
        let projetoEditando = null;
        let funcionarioEditando = null;

        // Elementos do DOM
        const projetosSection = document.getElementById('projetosSection');
        const funcionariosSection = document.getElementById('funcionariosSection');
        const projetosTab = document.getElementById('projetosTab');
        const funcionariosTab = document.getElementById('funcionariosTab');
        const projetosList = document.getElementById('projetosList');
        const funcionariosList = document.getElementById('funcionariosList');
        const projetoModal = document.getElementById('projetoModal');
        const funcionarioModal = document.getElementById('funcionarioModal');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            carregarProjetos();
            carregarFuncionarios();
        });

        function setupEventListeners() {
            // Tabs
            projetosTab.addEventListener('click', () => mostrarSecao('projetos'));
            funcionariosTab.addEventListener('click', () => mostrarSecao('funcionarios'));

            // Botões de novo
            document.getElementById('novoProjetoBtn').addEventListener('click', () => abrirModalProjeto());
            document.getElementById('novoFuncionarioBtn').addEventListener('click', () => abrirModalFuncionario());

            // Botões de busca
            document.getElementById('buscarProjetoBtn').addEventListener('click', buscarProjetoPorId);
            document.getElementById('buscarFuncionarioBtn').addEventListener('click', buscarFuncionarioPorId);
            document.getElementById('listarTodosProjetosBtn').addEventListener('click', carregarProjetos);
            document.getElementById('listarTodosFuncionariosBtn').addEventListener('click', carregarFuncionarios);

            // Modais
            document.getElementById('cancelarProjeto').addEventListener('click', () => fecharModalProjeto());
            document.getElementById('cancelarFuncionario').addEventListener('click', () => fecharModalFuncionario());

            // Formulários
            document.getElementById('projetoForm').addEventListener('submit', salvarProjeto);
            document.getElementById('funcionarioForm').addEventListener('submit', salvarFuncionario);

            // Fechar modais clicando fora
            projetoModal.addEventListener('click', (e) => {
                if (e.target === projetoModal) fecharModalProjeto();
            });
            funcionarioModal.addEventListener('click', (e) => {
                if (e.target === funcionarioModal) fecharModalFuncionario();
            });
        }

        function mostrarSecao(secao) {
            if (secao === 'projetos') {
                projetosSection.classList.remove('hidden');
                funcionariosSection.classList.add('hidden');
                projetosTab.className = 'px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-colors';
                funcionariosTab.className = 'px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors';
            } else {
                projetosSection.classList.add('hidden');
                funcionariosSection.classList.remove('hidden');
                funcionariosTab.className = 'px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-colors';
                projetosTab.className = 'px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors';
            }
        }

        // Funções para Projetos
        async function buscarProjetoPorId() {
            const id = document.getElementById('buscarProjetoId').value;
            if (!id) {
                mostrarToast('Por favor, insira um ID válido', 'error');
                return;
            }

            try {
                const response = await fetch(API_ENDPOINTS.projetos.getById(id));
                if (response.ok) {
                    const projeto = await response.json();
                    projetos = [projeto]; // Mostrar apenas o projeto encontrado
                    renderizarProjetos();
                    mostrarToast('Projeto encontrado!');
                    document.getElementById('buscarProjetoId').value = ''; // Limpar campo
                } else if (response.status === 404) {
                    mostrarToast('Projeto não encontrado', 'error');
                } else {
                    mostrarToast('Erro ao buscar projeto', 'error');
                }
            } catch (error) {
                console.error('Erro ao buscar projeto:', error);
                mostrarToast('Erro de conexão ao buscar projeto', 'error');
            }
        }

        async function carregarProjetos() {
            try {
                const response = await fetch(API_ENDPOINTS.projetos.get);
                if (response.ok) {
                    projetos = await response.json();
                    renderizarProjetos();
                } else {
                    console.error('Erro ao carregar projetos:', response.statusText);
                    mostrarToast('Erro ao carregar projetos', 'error');
                }
            } catch (error) {
                console.error('Erro ao carregar projetos:', error);
                mostrarToast('Erro de conexão ao carregar projetos', 'error');
            }
        }

        function renderizarProjetos() {
            projetosList.innerHTML = '';
            if (projetos.length === 0) {
                projetosList.innerHTML = '<div class="p-6 text-center text-gray-500">Nenhum projeto cadastrado</div>';
                return;
            }

            projetos.forEach(projeto => {
                const projetoDiv = document.createElement('div');
                projetoDiv.className = 'p-6 hover:bg-gray-50';
                projetoDiv.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="text-lg font-semibold text-gray-900">${projeto.nome}</h4>
                            <p class="text-sm text-gray-600 mt-1">${projeto.descricao || 'Sem descrição'}</p>
                            <p class="text-sm text-gray-500 mt-2">Criado em: ${new Date(projeto.dataCriacao).toLocaleDateString('pt-BR')}</p>
                            <div class="mt-2">
                                <span class="text-sm text-gray-500">Funcionários associados: ${projeto.funcionarios ? projeto.funcionarios.length : 0}</span>
                                ${projeto.funcionarios && projeto.funcionarios.length > 0 ? 
                                    `<div class="mt-1 text-xs text-gray-600">
                                        ${projeto.funcionarios.map(f => f.nome).join(', ')}
                                    </div>` : ''
                                }
                            </div>
                        </div>
                        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                            <button onclick="editarProjeto(${projeto.id})" class="px-3 py-1 text-xs sm:text-sm bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200 transition-colors">
                                Editar
                            </button>
                            <button onclick="excluirProjeto(${projeto.id})" class="px-3 py-1 text-xs sm:text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors">
                                Excluir
                            </button>
                        </div>
                    </div>
                `;
                projetosList.appendChild(projetoDiv);
            });
        }

        function abrirModalProjeto(projeto = null) {
            projetoEditando = projeto;
            const form = document.getElementById('projetoForm');
            const title = document.getElementById('projetoModalTitle');
            
            // Limpar funcionários associados
            document.getElementById('funcionariosProjetoContainer').innerHTML = `
                <div class="flex space-x-2">
                    <input type="text" placeholder="Nome do funcionário" 
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-nome">
                    <input type="text" placeholder="CPF" 
                           class="w-32 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-cpf">
                    <input type="email" placeholder="Email" 
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-email">
                    <input type="number" placeholder="Salário" step="0.01" 
                           class="w-24 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-salario">
                    <button type="button" onclick="removerFuncionarioProjeto(this)" class="px-2 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors">
                        -
                    </button>
                </div>
            `;
            
            if (projeto) {
                title.textContent = 'Editar Projeto';
                form.nome.value = projeto.nome;
                form.descricao.value = projeto.descricao || '';
                form.dataCriacao.value = projeto.dataCriacao;
            } else {
                title.textContent = 'Novo Projeto';
                form.reset();
                form.dataCriacao.value = new Date().toISOString().split('T')[0];
            }
            
            projetoModal.classList.remove('hidden');
        }

        function fecharModalProjeto() {
            projetoModal.classList.add('hidden');
            projetoEditando = null;
        }

        async function salvarProjeto(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const projeto = Object.fromEntries(formData.entries());

            // Coletar funcionários associados
            const funcionariosAssociados = coletarFuncionariosProjeto();
            if (funcionariosAssociados.length > 0) {
                projeto.funcionarios = funcionariosAssociados;
            }

            try {
                const response = await fetch(API_ENDPOINTS.projetos.post, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(projeto)
                });

                if (response.ok) {
                    mostrarToast('Projeto criado com sucesso!');
                    fecharModalProjeto();
                    carregarProjetos();
                } else {
                    const errorData = await response.json();
                    mostrarToast(`Erro ao salvar projeto: ${errorData.message || 'Erro desconhecido'}`, 'error');
                }
            } catch (error) {
                console.error('Erro ao salvar projeto:', error);
                mostrarToast('Erro de conexão ao salvar projeto', 'error');
            }
        }

        function editarProjeto(id) {
            mostrarToast('Funcionalidade de edição não disponível no momento', 'error');
        }

        function excluirProjeto(id) {
            mostrarToast('Funcionalidade de exclusão não disponível no momento', 'error');
        }

        // Funções para Funcionários
        async function buscarFuncionarioPorId() {
            const id = document.getElementById('buscarFuncionarioId').value;
            if (!id) {
                mostrarToast('Por favor, insira um ID válido', 'error');
                return;
            }

            try {
                const response = await fetch(API_ENDPOINTS.funcionarios.getById(id));
                if (response.ok) {
                    const funcionario = await response.json();
                    funcionarios = [funcionario]; // Mostrar apenas o funcionário encontrado
                    renderizarFuncionarios();
                    mostrarToast('Funcionário encontrado!');
                    document.getElementById('buscarFuncionarioId').value = ''; // Limpar campo
                } else if (response.status === 404) {
                    mostrarToast('Funcionário não encontrado', 'error');
                } else {
                    mostrarToast('Erro ao buscar funcionário', 'error');
                }
            } catch (error) {
                console.error('Erro ao buscar funcionário:', error);
                mostrarToast('Erro de conexão ao buscar funcionário', 'error');
            }
        }

        async function carregarFuncionarios() {
            try {
                const response = await fetch(API_ENDPOINTS.funcionarios.get);
                if (response.ok) {
                    funcionarios = await response.json();
                    renderizarFuncionarios();
                } else {
                    console.error('Erro ao carregar funcionários:', response.statusText);
                    mostrarToast('Erro ao carregar funcionários', 'error');
                }
            } catch (error) {
                console.error('Erro ao carregar funcionários:', error);
                mostrarToast('Erro de conexão ao carregar funcionários', 'error');
            }
        }

        function renderizarFuncionarios() {
            funcionariosList.innerHTML = '';
            if (funcionarios.length === 0) {
                funcionariosList.innerHTML = '<div class="p-6 text-center text-gray-500">Nenhum funcionário cadastrado</div>';
                return;
            }

            funcionarios.forEach(funcionario => {
                const funcionarioDiv = document.createElement('div');
                funcionarioDiv.className = 'p-6 hover:bg-gray-50';
                funcionarioDiv.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="text-lg font-semibold text-gray-900">${funcionario.nome}</h4>
                            <p class="text-sm text-gray-600">CPF: ${funcionario.cpf}</p>
                            <p class="text-sm text-gray-600">Email: ${funcionario.email}</p>
                            <p class="text-sm text-gray-600">Salário: R$ ${parseFloat(funcionario.salario).toFixed(2)}</p>
                            <div class="mt-2">
                                <span class="text-sm text-gray-500">Projetos associados: ${funcionario.projetos ? funcionario.projetos.length : 0}</span>
                                ${funcionario.projetos && funcionario.projetos.length > 0 ? 
                                    `<div class="mt-1 text-xs text-gray-600">
                                        ${funcionario.projetos.map(p => p.nome).join(', ')}
                                    </div>` : ''
                                }
                            </div>
                        </div>
                        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                            <button onclick="editarFuncionario(${funcionario.id})" class="px-3 py-1 text-xs sm:text-sm bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200 transition-colors">
                                Editar
                            </button>
                            <button onclick="excluirFuncionario(${funcionario.id})" class="px-3 py-1 text-xs sm:text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors">
                                Excluir
                            </button>
                        </div>
                    </div>
                `;
                funcionariosList.appendChild(funcionarioDiv);
            });
        }

        function abrirModalFuncionario(funcionario = null) {
            funcionarioEditando = funcionario;
            const form = document.getElementById('funcionarioForm');
            const title = document.getElementById('funcionarioModalTitle');
            
            // Limpar projetos associados
            document.getElementById('projetosFuncionarioContainer').innerHTML = `
                <div class="flex space-x-2">
                    <input type="text" placeholder="Nome do projeto" 
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary projeto-nome">
                    <textarea placeholder="Descrição" rows="2" 
                              class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary projeto-descricao"></textarea>
                    <button type="button" onclick="removerProjetoFuncionario(this)" class="px-2 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors">
                        -
                    </button>
                </div>
            `;
            
            if (funcionario) {
                title.textContent = 'Editar Funcionário';
                form.nome.value = funcionario.nome;
                form.cpf.value = funcionario.cpf;
                form.email.value = funcionario.email;
                form.salario.value = funcionario.salario;
            } else {
                title.textContent = 'Novo Funcionário';
                form.reset();
            }
            
            funcionarioModal.classList.remove('hidden');
        }

        function fecharModalFuncionario() {
            funcionarioModal.classList.add('hidden');
            funcionarioEditando = null;
        }

        async function salvarFuncionario(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const funcionario = Object.fromEntries(formData.entries());

            // Coletar projetos associados
            const projetosAssociados = coletarProjetosFuncionario();
            if (projetosAssociados.length > 0) {
                funcionario.projetos = projetosAssociados;
            }

            try {
                const response = await fetch(API_ENDPOINTS.funcionarios.post, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(funcionario)
                });

                if (response.ok) {
                    mostrarToast('Funcionário criado com sucesso!');
                    fecharModalFuncionario();
                    carregarFuncionarios();
                } else {
                    const errorData = await response.json();
                    mostrarToast(`Erro ao salvar funcionário: ${errorData.message || 'Erro desconhecido'}`, 'error');
                }
            } catch (error) {
                console.error('Erro ao salvar funcionário:', error);
                mostrarToast('Erro de conexão ao salvar funcionário', 'error');
            }
        }

        function editarFuncionario(id) {
            mostrarToast('Funcionalidade de edição não disponível no momento', 'error');
        }

        function excluirFuncionario(id) {
            mostrarToast('Funcionalidade de exclusão não disponível no momento', 'error');
        }


        // Funções auxiliares para associações
        function adicionarFuncionarioProjeto() {
            const container = document.getElementById('funcionariosProjetoContainer');
            const div = document.createElement('div');
            div.className = 'flex space-x-2';
            div.innerHTML = `
                <input type="text" placeholder="Nome do funcionário" 
                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-nome">
                <input type="text" placeholder="CPF" 
                       class="w-32 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-cpf">
                <input type="email" placeholder="Email" 
                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-email">
                <input type="number" placeholder="Salário" step="0.01" 
                       class="w-24 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary funcionario-salario">
                <button type="button" onclick="removerFuncionarioProjeto(this)" class="px-2 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors">
                    -
                </button>
            `;
            container.appendChild(div);
        }

        function removerFuncionarioProjeto(button) {
            button.parentElement.remove();
        }

        function adicionarProjetoFuncionario() {
            const container = document.getElementById('projetosFuncionarioContainer');
            const div = document.createElement('div');
            div.className = 'flex space-x-2';
            div.innerHTML = `
                <input type="text" placeholder="Nome do projeto" 
                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary projeto-nome">
                <textarea placeholder="Descrição" rows="2" 
                          class="flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary projeto-descricao"></textarea>
                <button type="button" onclick="removerProjetoFuncionario(this)" class="px-2 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors">
                    -
                </button>
            `;
            container.appendChild(div);
        }

        function removerProjetoFuncionario(button) {
            button.parentElement.remove();
        }

        function coletarFuncionariosProjeto() {
            const funcionarios = [];
            const container = document.getElementById('funcionariosProjetoContainer');
            const rows = container.querySelectorAll('.flex.space-x-2');
            
            rows.forEach(row => {
                const nome = row.querySelector('.funcionario-nome').value;
                const cpf = row.querySelector('.funcionario-cpf').value;
                const email = row.querySelector('.funcionario-email').value;
                const salario = row.querySelector('.funcionario-salario').value;
                
                if (nome && cpf && email && salario) {
                    funcionarios.push({
                        nome: nome,
                        cpf: cpf,
                        email: email,
                        salario: parseFloat(salario)
                    });
                }
            });
            
            return funcionarios;
        }

        function coletarProjetosFuncionario() {
            const projetos = [];
            const container = document.getElementById('projetosFuncionarioContainer');
            const rows = container.querySelectorAll('.flex.space-x-2');
            
            rows.forEach(row => {
                const nome = row.querySelector('.projeto-nome').value;
                const descricao = row.querySelector('.projeto-descricao').value;
                
                if (nome) {
                    projetos.push({
                        nome: nome,
                        descricao: descricao || ''
                    });
                }
            });
            
            return projetos;
        }

        // Função para mostrar toast
        function mostrarToast(message, type = 'success') {
            toastMessage.textContent = message;
            toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg transform translate-x-0 opacity-100 transition-all duration-300 pointer-events-auto ${
                type === 'error' ? 'bg-red-500 text-white' : 'bg-green-500 text-white'
            }`;
            
            setTimeout(() => {
                toast.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full opacity-0 transition-all duration-300 pointer-events-none';
            }, 3000);
        }
    </script>
</body>
</html>
